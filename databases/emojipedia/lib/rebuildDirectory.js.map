{"version":3,"sources":["../src/rebuildDirectory.ts"],"sourcesContent":["import * as fs from \"node:fs/promises\";\nimport * as path from \"node:path\";\n\nimport { formatExportLine } from \"./formatExportLine.js\";\nimport { getEmojis } from \"./getEmojis.js\";\nimport { EmojiV1TechnicalInformation } from \"./types.js\";\nimport { unicodeEmoji } from \"./unicodeEmoji.js\";\n\nexport interface RebuildSettings {\n\tdirectory: string;\n}\n\nexport async function rebuildDirectory({ directory }: RebuildSettings) {\n\tawait fs.rm(directory, { force: true, recursive: true });\n\tawait fs.mkdir(directory, { recursive: true });\n\n\tconst index = path.join(directory, \"index\");\n\tawait fs.writeFile(`${index}.d.mts`, \"\");\n\tawait fs.writeFile(`${index}.mjs`, \"\");\n\n\tconst foundInfo: EmojiV1TechnicalInformation[] = [];\n\n\tfor await (const retrieved of getEmojis(\n\t\tObject.values(unicodeEmoji)\n\t\t\t.map(({ slug }) => slug.replaceAll(\"_\", \"-\"))\n\t\t\t.sort(),\n\t)) {\n\t\tif (!retrieved.found) {\n\t\t\tthrow new Error(`Could not find slug on Emojipedia: ${retrieved.slug}`);\n\t\t}\n\n\t\tconst fileContents = JSON.stringify(\n\t\t\tObject.fromEntries(\n\t\t\t\tObject.entries(retrieved.info).sort(([a], [b]) => a.localeCompare(b)),\n\t\t\t),\n\t\t\tnull,\n\t\t\t4,\n\t\t);\n\t\tconst filePathStart = path.join(directory, retrieved.slug);\n\n\t\tawait Promise.all([\n\t\t\tfs.appendFile(`${index}.d.mts`, formatExportLine(retrieved.info)),\n\t\t\tfs.appendFile(`${index}.mjs`, formatExportLine(retrieved.info)),\n\t\t\tfs.writeFile(`${filePathStart}.json`, fileContents),\n\t\t\tfs.writeFile(`${filePathStart}.d.ts`, fileContents),\n\t\t]);\n\n\t\tfoundInfo.push(retrieved.info);\n\t}\n}\n"],"mappings":"AAAA,YAAY,QAAQ;AACpB,YAAY,UAAU;AAEtB,SAAS,wBAAwB;AACjC,SAAS,iBAAiB;AAE1B,SAAS,oBAAoB;AAM7B,eAAsB,iBAAiB,EAAE,UAAU,GAAoB;AACtE,QAAM,GAAG,GAAG,WAAW,EAAE,OAAO,MAAM,WAAW,KAAK,CAAC;AACvD,QAAM,GAAG,MAAM,WAAW,EAAE,WAAW,KAAK,CAAC;AAE7C,QAAM,QAAQ,KAAK,KAAK,WAAW,OAAO;AAC1C,QAAM,GAAG,UAAU,GAAG,KAAK,UAAU,EAAE;AACvC,QAAM,GAAG,UAAU,GAAG,KAAK,QAAQ,EAAE;AAErC,QAAM,YAA2C,CAAC;AAElD,mBAAiB,aAAa;AAAA,IAC7B,OAAO,OAAO,YAAY,EACxB,IAAI,CAAC,EAAE,KAAK,MAAM,KAAK,WAAW,KAAK,GAAG,CAAC,EAC3C,KAAK;AAAA,EACR,GAAG;AACF,QAAI,CAAC,UAAU,OAAO;AACrB,YAAM,IAAI,MAAM,sCAAsC,UAAU,IAAI,EAAE;AAAA,IACvE;AAEA,UAAM,eAAe,KAAK;AAAA,MACzB,OAAO;AAAA,QACN,OAAO,QAAQ,UAAU,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;AAAA,MACrE;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,UAAM,gBAAgB,KAAK,KAAK,WAAW,UAAU,IAAI;AAEzD,UAAM,QAAQ,IAAI;AAAA,MACjB,GAAG,WAAW,GAAG,KAAK,UAAU,iBAAiB,UAAU,IAAI,CAAC;AAAA,MAChE,GAAG,WAAW,GAAG,KAAK,QAAQ,iBAAiB,UAAU,IAAI,CAAC;AAAA,MAC9D,GAAG,UAAU,GAAG,aAAa,SAAS,YAAY;AAAA,MAClD,GAAG,UAAU,GAAG,aAAa,SAAS,YAAY;AAAA,IACnD,CAAC;AAED,cAAU,KAAK,UAAU,IAAI;AAAA,EAC9B;AACD;","names":[]}